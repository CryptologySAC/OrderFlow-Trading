yarn run v1.22.22
$ vitest test/absorptionDetector_specifications.test.ts -t 'MUST detect absorption when price efficiency is below threshold'

 RUN  v3.2.3 /Users/marcschot/Projects/OrderFlow Trading

stdout | test/absorptionDetector_specifications.test.ts > AbsorptionDetector - Specification Compliance > SPECIFICATION: Price Efficiency Analysis > MUST detect absorption when price efficiency is below threshold
ğŸ” Test data: {
  tradeCount: [33m5[39m,
  firstTrade: {
    price: [33m100.5[39m,
    quantity: [33m400[39m,
    timestamp: [33m1750807836372[39m,
    buyerIsMaker: [33mfalse[39m,
    pair: [32m'TESTUSDT'[39m,
    tradeId: [32m'test_1750807836372'[39m,
    originalTrade: { p: [32m'100.5'[39m, q: [32m'400'[39m, T: [33m1750807836372[39m, m: [33mfalse[39m },
    passiveBidVolume: [33m1000[39m,
    passiveAskVolume: [33m1000[39m,
    zonePassiveBidVolume: [33m500[39m,
    zonePassiveAskVolume: [33m500[39m,
    bestBid: [33m100.49[39m,
    bestAsk: [33m100.51[39m
  },
  lastTrade: {
    price: [33m100.55[39m,
    quantity: [33m400[39m,
    timestamp: [33m1750807840372[39m,
    buyerIsMaker: [33mfalse[39m,
    pair: [32m'TESTUSDT'[39m,
    tradeId: [32m'test_1750807836376'[39m,
    originalTrade: { p: [32m'100.55'[39m, q: [32m'400'[39m, T: [33m1750807840372[39m, m: [33mfalse[39m },
    passiveBidVolume: [33m1000[39m,
    passiveAskVolume: [33m1000[39m,
    zonePassiveBidVolume: [33m500[39m,
    zonePassiveAskVolume: [33m500[39m,
    bestBid: [33m100.53999999999999[39m,
    bestAsk: [33m100.56[39m
  },
  totalVolume: [33m2000[39m,
  settings: {
    minAggVolume: [33m40[39m,
    priceEfficiencyThreshold: [33m0.02[39m,
    absorptionThreshold: [33m0.6[39m
  }
}
ğŸ¯ Creating TRUE absorption scenario...
ğŸ“Š TRUE ABSORPTION: 310 total volume, 0 price movement
ğŸ“Š Ratio: 0.0000 price per 1M volume
ğŸ“Š Expected: MASSIVE volume + TINY price movement = efficiency << 0.02 (2%)
ğŸ”„ Trade 1: price=84.94, aggVolume=40, passiveAsk=1800 (real absorption)
ğŸ” Zone 84.93 passive volume tracking: {
  zonePassiveBidVolume: [33m300[39m,
  zonePassiveAskVolume: [33m300[39m,
  historyCount: [33m0[39m,
  lastSnapshot: [1mnull[22m
}
ğŸ” AbsorptionDetector.checkForSignal called {
  triggerTrade: {
    price: [33m84.94[39m,
    quantity: [33m40[39m,
    tradeId: [32m'absorption_0'[39m,
    buyerIsMaker: [33mfalse[39m
  },
  zoneAggSize: [33m1[39m,
  windowMs: [33m60000[39m
}
ğŸ” Processing zone 84.93: { tradesBeforeFilter: [33m1[39m, totalVolume: [33m40[39m }
ğŸ” Zone 84.93 after filtering: {
  tradesAfterFilter: [33m1[39m,
  totalVolumeAfterFilter: [33m40[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ¯ Analyzing zone 84.93 for absorption...
ğŸ¯ analyzeZoneForAbsorption started for zone 84.93
ğŸ” Zone 84.93 analysis: {
  tradesCount: [33m1[39m,
  latestPrice: [33m84.94[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
ğŸ” Zone 84.93 absorbing side analysis: { absorbingSide: [1mnull[22m, priceEfficiencyThreshold: [33m0.02[39m }
âŒ Zone 84.93: No clear absorption detected - returning early
ğŸ”„ Trade 2: price=84.94, aggVolume=50, passiveAsk=1740 (real absorption)
ğŸ” Zone 84.93 passive volume tracking: {
  zonePassiveBidVolume: [33m300[39m,
  zonePassiveAskVolume: [33m290[39m,
  historyCount: [33m1[39m,
  lastSnapshot: { bid: [33m300[39m, ask: [33m300[39m, timestamp: [33m1750807826373[39m }
}
ğŸ” AbsorptionDetector.checkForSignal called {
  triggerTrade: {
    price: [33m84.94[39m,
    quantity: [33m50[39m,
    tradeId: [32m'absorption_1'[39m,
    buyerIsMaker: [33mfalse[39m
  },
  zoneAggSize: [33m1[39m,
  windowMs: [33m60000[39m
}
ğŸ” Processing zone 84.93: { tradesBeforeFilter: [33m2[39m, totalVolume: [33m90[39m }
ğŸ” Zone 84.93 after filtering: {
  tradesAfterFilter: [33m2[39m,
  totalVolumeAfterFilter: [33m90[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ¯ Analyzing zone 84.93 for absorption...
ğŸ¯ analyzeZoneForAbsorption started for zone 84.93
ğŸ” Zone 84.93 analysis: {
  tradesCount: [33m2[39m,
  latestPrice: [33m84.94[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
ğŸ” Zone 84.93 absorbing side analysis: { absorbingSide: [1mnull[22m, priceEfficiencyThreshold: [33m0.02[39m }
âŒ Zone 84.93: No clear absorption detected - returning early
ğŸ”„ Trade 3: price=84.94, aggVolume=110, passiveAsk=1680 (real absorption)
ğŸ” Zone 84.93 passive volume tracking: {
  zonePassiveBidVolume: [33m300[39m,
  zonePassiveAskVolume: [33m280[39m,
  historyCount: [33m2[39m,
  lastSnapshot: { bid: [33m300[39m, ask: [33m290[39m, timestamp: [33m1750808006373[39m }
}
ğŸ” AbsorptionDetector.checkForSignal called {
  triggerTrade: {
    price: [33m84.94[39m,
    quantity: [33m110[39m,
    tradeId: [32m'absorption_2'[39m,
    buyerIsMaker: [33mfalse[39m
  },
  zoneAggSize: [33m1[39m,
  windowMs: [33m60000[39m
}
ğŸ” Processing zone 84.93: { tradesBeforeFilter: [33m3[39m, totalVolume: [33m200[39m }
ğŸ” Zone 84.93 after filtering: {
  tradesAfterFilter: [33m3[39m,
  totalVolumeAfterFilter: [33m200[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ¯ Analyzing zone 84.93 for absorption...
ğŸ¯ analyzeZoneForAbsorption started for zone 84.93
ğŸ” Zone 84.93 analysis: {
  tradesCount: [33m3[39m,
  latestPrice: [33m84.94[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
ğŸ” Zone 84.93 getAbsorbingSideForZone: {
  tradesCount: [33m3[39m,
  dominantAggressiveSide: [32m'buy'[39m,
  priceEfficiency: [33m0[39m,
  priceEfficiencyThreshold: [33m0.02[39m,
  priceEfficiencyBelowThreshold: [33mtrue[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
âœ… Zone 84.93: Price efficiency absorption detected - ask side absorbing
ğŸ” Zone 84.93 absorbing side analysis: { absorbingSide: [32m'ask'[39m, priceEfficiencyThreshold: [33m0.02[39m }
ğŸ” Zone 84.93 cooldown check: { passed: [33mtrue[39m }
ğŸ” Zone 84.93: Analyzing absorption conditions...
ğŸ” analyzeAbsorptionConditions for zone 84.93: { hasZoneHistory: [33mtrue[39m, historyCount: [33m3[39m, windowMs: [33m60000[39m }
ğŸ” Zone 84.93 snapshots after time filtering: {
  totalSnapshots: [33m3[39m,
  filteredSnapshots: [33m3[39m,
  timeWindow: [33m60000[39m,
  oldestSnapshot: [33m1750807826373[39m,
  newestSnapshot: [33m1750808246373[39m,
  currentTime: [33m1750807836375[39m
}
ğŸ” Zone 84.93 starting calculations...
âœ… Zone 84.93 relevantPassiveValues populated: [33m3[39m
âœ… Zone 84.93 currentPassive: [33m300[39m
âœ… Zone 84.93 avgPassive: [33m300[39m
âœ… Zone 84.93 maxPassive: [33m300[39m minPassive: [33m300[39m
âœ… Zone 84.93 EWMA values - agg: [33m0.024996406647091657[39m pas: [33m0.10872929948213919[39m
âœ… Zone 84.93 absorptionRatio: [33m0.22989577571221068[39m
âœ… Zone 84.93 passiveStrength: [33m1[39m
âœ… Zone 84.93 icebergSignal: [33m0[39m
âœ… Zone 84.93 liquidityGradient: [33m0[39m
âœ… Zone 84.93 absorptionVelocity: [33m0[39m
âœ… Zone 84.93 consistency: [33m1[39m
âœ… Zone 84.93 velocityIncrease: [33m1[39m
âœ… Zone 84.93 spread: [33m0[39m
âœ… Zone 84.93 imbalanceResult: { imbalance: [33m0.01694915254237288[39m, dominantSide: [32m'neutral'[39m }
âœ… Zone 84.93 microstructureInsights: [90mundefined[39m
âœ… Zone 84.93 populating conditions object...
âœ… Zone 84.93 conditions populated successfully!
âœ… Zone 84.93 returning conditions object: {
  absorptionRatio: [33m0.22989577571221068[39m,
  passiveStrength: [33m1[39m,
  sampleCount: [33m3[39m
}
ğŸ” Zone 84.93 conditions result: {
  hasConditions: [33mtrue[39m,
  conditions: {
    absorptionRatio: [33m0.22989577571221068[39m,
    passiveStrength: [33m1[39m,
    aggressiveVolume: [33m0.024996406647091657[39m,
    avgPassive: [33m300[39m
  }
}
ğŸ” Zone 84.93: Calculating absorption score...
ğŸ“Š Simple absorption calculation: {
  absorptionRatio: [32m'0.230'[39m,
  threshold: [33m1[39m,
  isAbsorption: [33mtrue[39m,
  confidence: [32m'0.770'[39m
}
ğŸ” Zone 84.93 score analysis: {
  score: [33m0.7701042242877894[39m,
  absorptionThreshold: [33m0.6[39m,
  passesScoreCheck: [33mtrue[39m,
  thresholds: {
    strong: [33m0.09900000000000002[39m,
    moderate: [33m0.29700000000000004[39m,
    weak: [33m0.49500000000000005[39m
  },
  absorptionRatio: [33m0.22989577571221068[39m,
  ratioTooHigh: [33mfalse[39m
}
ğŸ” Zone 84.93: Calculating zone volumes...
ğŸ” Zone 84.93 volume analysis: {
  aggressiveVolume: [33m200[39m,
  passiveVolume: [33m590[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ” Zone 84.93 absorption ratio check: { absorptionRatio: [32m'0.339'[39m, maxAbsorptionRatio: [33m0.7[39m, passes: [33mtrue[39m }
ğŸ” Zone 84.93: Calculating absorption context...
âœ… Zone 84.93: Absorption context calculated: {
  isReversal: [33mfalse[39m,
  strength: [33m0.5[39m,
  priceContext: [32m'middle'[39m,
  contextConfidence: [33m0[39m
}
ğŸ” Zone 84.93: Starting confidence adjustments with score 0.7701042242877894
ğŸ” Zone 84.93: Completed confidence adjustments, finalConfidence: 0.7701042242877894
ğŸ” Zone 84.93: Moving to signal creation...
ğŸ”„ Trade 4: price=84.94, aggVolume=85, passiveAsk=1620 (real absorption)
ğŸ” Zone 84.93 passive volume tracking: {
  zonePassiveBidVolume: [33m300[39m,
  zonePassiveAskVolume: [33m270[39m,
  historyCount: [33m3[39m,
  lastSnapshot: { bid: [33m300[39m, ask: [33m280[39m, timestamp: [33m1750808246373[39m }
}
ğŸ” AbsorptionDetector.checkForSignal called {
  triggerTrade: {
    price: [33m84.94[39m,
    quantity: [33m85[39m,
    tradeId: [32m'absorption_3'[39m,
    buyerIsMaker: [33mfalse[39m
  },
  zoneAggSize: [33m1[39m,
  windowMs: [33m60000[39m
}
ğŸ” Processing zone 84.93: { tradesBeforeFilter: [33m4[39m, totalVolume: [33m285[39m }
ğŸ” Zone 84.93 after filtering: {
  tradesAfterFilter: [33m4[39m,
  totalVolumeAfterFilter: [33m285[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ¯ Analyzing zone 84.93 for absorption...
ğŸ¯ analyzeZoneForAbsorption started for zone 84.93
ğŸ” Zone 84.93 analysis: {
  tradesCount: [33m4[39m,
  latestPrice: [33m84.94[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
ğŸ” Zone 84.93 getAbsorbingSideForZone: {
  tradesCount: [33m4[39m,
  dominantAggressiveSide: [32m'buy'[39m,
  priceEfficiency: [33m0[39m,
  priceEfficiencyThreshold: [33m0.02[39m,
  priceEfficiencyBelowThreshold: [33mtrue[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
âœ… Zone 84.93: Price efficiency absorption detected - ask side absorbing
ğŸ” Zone 84.93 absorbing side analysis: { absorbingSide: [32m'ask'[39m, priceEfficiencyThreshold: [33m0.02[39m }
ğŸ” Zone 84.93 cooldown check: { passed: [33mtrue[39m }
ğŸ” Zone 84.93: Analyzing absorption conditions...
ğŸ” analyzeAbsorptionConditions for zone 84.93: { hasZoneHistory: [33mtrue[39m, historyCount: [33m4[39m, windowMs: [33m60000[39m }
ğŸ” Zone 84.93 snapshots after time filtering: {
  totalSnapshots: [33m4[39m,
  filteredSnapshots: [33m4[39m,
  timeWindow: [33m60000[39m,
  oldestSnapshot: [33m1750807826373[39m,
  newestSnapshot: [33m1750808486373[39m,
  currentTime: [33m1750807836379[39m
}
ğŸ” Zone 84.93 starting calculations...
âœ… Zone 84.93 relevantPassiveValues populated: [33m4[39m
âœ… Zone 84.93 currentPassive: [33m300[39m
âœ… Zone 84.93 avgPassive: [33m300[39m
âœ… Zone 84.93 maxPassive: [33m300[39m minPassive: [33m300[39m
âœ… Zone 84.93 EWMA values - agg: [33m0.07808919066964667[39m pas: [33m0.2773586415113335[39m
âœ… Zone 84.93 absorptionRatio: [33m0.28154590837385457[39m
âœ… Zone 84.93 passiveStrength: [33m1[39m
âœ… Zone 84.93 icebergSignal: [33m0[39m
âœ… Zone 84.93 liquidityGradient: [33m0[39m
âœ… Zone 84.93 absorptionVelocity: [33m0[39m
âœ… Zone 84.93 consistency: [33m1[39m
âœ… Zone 84.93 velocityIncrease: [33m1[39m
âœ… Zone 84.93 spread: [33m0[39m
âœ… Zone 84.93 imbalanceResult: { imbalance: [33m0.02564102564102564[39m, dominantSide: [32m'neutral'[39m }
âœ… Zone 84.93 microstructureInsights: [90mundefined[39m
âœ… Zone 84.93 populating conditions object...
âœ… Zone 84.93 conditions populated successfully!
âœ… Zone 84.93 returning conditions object: {
  absorptionRatio: [33m0.28154590837385457[39m,
  passiveStrength: [33m1[39m,
  sampleCount: [33m4[39m
}
ğŸ” Zone 84.93 conditions result: {
  hasConditions: [33mtrue[39m,
  conditions: {
    absorptionRatio: [33m0.28154590837385457[39m,
    passiveStrength: [33m1[39m,
    aggressiveVolume: [33m0.07808919066964667[39m,
    avgPassive: [33m300[39m
  }
}
ğŸ” Zone 84.93: Calculating absorption score...
ğŸ“Š Simple absorption calculation: {
  absorptionRatio: [32m'0.282'[39m,
  threshold: [33m1[39m,
  isAbsorption: [33mtrue[39m,
  confidence: [32m'0.718'[39m
}
ğŸ” Zone 84.93 score analysis: {
  score: [33m0.7184540916261455[39m,
  absorptionThreshold: [33m0.6[39m,
  passesScoreCheck: [33mtrue[39m,
  thresholds: {
    strong: [33m0.09900000000000002[39m,
    moderate: [33m0.29700000000000004[39m,
    weak: [33m0.49500000000000005[39m
  },
  absorptionRatio: [33m0.28154590837385457[39m,
  ratioTooHigh: [33mfalse[39m
}
ğŸ” Zone 84.93: Calculating zone volumes...
ğŸ” Zone 84.93 volume analysis: {
  aggressiveVolume: [33m285[39m,
  passiveVolume: [33m585[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ” Zone 84.93 absorption ratio check: { absorptionRatio: [32m'0.487'[39m, maxAbsorptionRatio: [33m0.7[39m, passes: [33mtrue[39m }
ğŸ” Zone 84.93: Calculating absorption context...
âœ… Zone 84.93: Absorption context calculated: {
  isReversal: [33mfalse[39m,
  strength: [33m0.5[39m,
  priceContext: [32m'middle'[39m,
  contextConfidence: [33m0[39m
}
ğŸ” Zone 84.93: Starting confidence adjustments with score 0.7184540916261455
ğŸ” Zone 84.93: Completed confidence adjustments, finalConfidence: 0.7184540916261455
ğŸ” Zone 84.93: Moving to signal creation...
ğŸ”„ Trade 5: price=84.94, aggVolume=25, passiveAsk=1560 (real absorption)
ğŸ” Zone 84.93 passive volume tracking: {
  zonePassiveBidVolume: [33m300[39m,
  zonePassiveAskVolume: [33m260[39m,
  historyCount: [33m4[39m,
  lastSnapshot: { bid: [33m300[39m, ask: [33m270[39m, timestamp: [33m1750808486373[39m }
}
ğŸ” AbsorptionDetector.checkForSignal called {
  triggerTrade: {
    price: [33m84.94[39m,
    quantity: [33m25[39m,
    tradeId: [32m'absorption_4'[39m,
    buyerIsMaker: [33mfalse[39m
  },
  zoneAggSize: [33m1[39m,
  windowMs: [33m60000[39m
}
ğŸ” Processing zone 84.93: { tradesBeforeFilter: [33m5[39m, totalVolume: [33m310[39m }
ğŸ” Zone 84.93 after filtering: {
  tradesAfterFilter: [33m5[39m,
  totalVolumeAfterFilter: [33m310[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ¯ Analyzing zone 84.93 for absorption...
ğŸ¯ analyzeZoneForAbsorption started for zone 84.93
ğŸ” Zone 84.93 analysis: {
  tradesCount: [33m5[39m,
  latestPrice: [33m84.94[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
ğŸ” Zone 84.93 getAbsorbingSideForZone: {
  tradesCount: [33m5[39m,
  dominantAggressiveSide: [32m'buy'[39m,
  priceEfficiency: [33m0[39m,
  priceEfficiencyThreshold: [33m0.02[39m,
  priceEfficiencyBelowThreshold: [33mtrue[39m,
  priceRange: { min: [33m84.94[39m, max: [33m84.94[39m }
}
âœ… Zone 84.93: Price efficiency absorption detected - ask side absorbing
ğŸ” Zone 84.93 absorbing side analysis: { absorbingSide: [32m'ask'[39m, priceEfficiencyThreshold: [33m0.02[39m }
ğŸ” Zone 84.93 cooldown check: { passed: [33mtrue[39m }
ğŸ” Zone 84.93: Analyzing absorption conditions...
ğŸ” analyzeAbsorptionConditions for zone 84.93: { hasZoneHistory: [33mtrue[39m, historyCount: [33m5[39m, windowMs: [33m60000[39m }
ğŸ” Zone 84.93 snapshots after time filtering: {
  totalSnapshots: [33m5[39m,
  filteredSnapshots: [33m5[39m,
  timeWindow: [33m60000[39m,
  oldestSnapshot: [33m1750807826373[39m,
  newestSnapshot: [33m1750808726373[39m,
  currentTime: [33m1750807836379[39m
}
ğŸ” Zone 84.93 starting calculations...
âœ… Zone 84.93 relevantPassiveValues populated: [33m5[39m
âœ… Zone 84.93 currentPassive: [33m300[39m
âœ… Zone 84.93 avgPassive: [33m300[39m
âœ… Zone 84.93 maxPassive: [33m300[39m minPassive: [33m300[39m
âœ… Zone 84.93 EWMA values - agg: [33m0.08120423482649605[39m pas: [33m0.3098219426825403[39m
âœ… Zone 84.93 absorptionRatio: [33m0.2620996890129959[39m
âœ… Zone 84.93 passiveStrength: [33m1[39m
âœ… Zone 84.93 icebergSignal: [33m0[39m
âœ… Zone 84.93 liquidityGradient: [33m0[39m
âœ… Zone 84.93 absorptionVelocity: [33m0[39m
âœ… Zone 84.93 consistency: [33m1[39m
âœ… Zone 84.93 velocityIncrease: [33m1[39m
âœ… Zone 84.93 spread: [33m0[39m
âœ… Zone 84.93 imbalanceResult: { imbalance: [33m0.034482758620689655[39m, dominantSide: [32m'neutral'[39m }
âœ… Zone 84.93 microstructureInsights: [90mundefined[39m
âœ… Zone 84.93 populating conditions object...
âœ… Zone 84.93 conditions populated successfully!
âœ… Zone 84.93 returning conditions object: {
  absorptionRatio: [33m0.2620996890129959[39m,
  passiveStrength: [33m1[39m,
  sampleCount: [33m5[39m
}
ğŸ” Zone 84.93 conditions result: {
  hasConditions: [33mtrue[39m,
  conditions: {
    absorptionRatio: [33m0.2620996890129959[39m,
    passiveStrength: [33m1[39m,
    aggressiveVolume: [33m0.08120423482649605[39m,
    avgPassive: [33m300[39m
  }
}
ğŸ” Zone 84.93: Calculating absorption score...
ğŸ“Š Simple absorption calculation: {
  absorptionRatio: [32m'0.262'[39m,
  threshold: [33m1[39m,
  isAbsorption: [33mtrue[39m,
  confidence: [32m'0.738'[39m
}
ğŸ” Zone 84.93 score analysis: {
  score: [33m0.7379003109870041[39m,
  absorptionThreshold: [33m0.6[39m,
  passesScoreCheck: [33mtrue[39m,
  thresholds: {
    strong: [33m0.09900000000000002[39m,
    moderate: [33m0.29700000000000004[39m,
    weak: [33m0.49500000000000005[39m
  },
  absorptionRatio: [33m0.2620996890129959[39m,
  ratioTooHigh: [33mfalse[39m
}
ğŸ” Zone 84.93: Calculating zone volumes...
ğŸ” Zone 84.93 volume analysis: {
  aggressiveVolume: [33m310[39m,
  passiveVolume: [33m580[39m,
  minAggVolume: [33m40[39m,
  passesVolumeCheck: [33mtrue[39m
}
ğŸ” Zone 84.93 absorption ratio check: { absorptionRatio: [32m'0.534'[39m, maxAbsorptionRatio: [33m0.7[39m, passes: [33mtrue[39m }
ğŸ” Zone 84.93: Calculating absorption context...
âœ… Zone 84.93: Absorption context calculated: {
  isReversal: [33mfalse[39m,
  strength: [33m0.5[39m,
  priceContext: [32m'middle'[39m,
  contextConfidence: [33m0[39m
}
ğŸ” Zone 84.93: Starting confidence adjustments with score 0.7379003109870041
ğŸ” Zone 84.93: Completed confidence adjustments, finalConfidence: 0.7379003109870041
ğŸ” Zone 84.93: Moving to signal creation...
ğŸ“Š Result: { signalDetected: [33mfalse[39m, signalCount: [33m0[39m }

 â¯ test/absorptionDetector_specifications.test.ts (13 tests | 1 failed | 12 skipped) 14ms
   Ã— AbsorptionDetector - Specification Compliance > SPECIFICATION: Price Efficiency Analysis > MUST detect absorption when price efficiency is below threshold 13ms
     â†’ expected false to be true // Object.is equality
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Price Efficiency Analysis > MUST NOT detect absorption when price efficiency is above threshold
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Price Efficiency Analysis > MUST use FinancialMath for all price efficiency calculations
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Volume Surge Detection > MUST enhance confidence when volume surge (4x) is detected
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Volume Surge Detection > MUST require minimum volume threshold for surge detection
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Order Flow Imbalance Analysis > MUST detect directional bias with 35% imbalance threshold
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Order Flow Imbalance Analysis > MUST NOT trigger on balanced order flow
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Iceberg Order Detection > MUST detect maintained passive liquidity despite aggressive hits
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Iceberg Order Detection > MUST use configurable ratios for iceberg detection
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Configuration Compliance > MUST use all configurable thresholds instead of magic numbers
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Configuration Compliance > MUST return null when insufficient data for analysis
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Signal Quality Requirements > MUST emit signals with required metadata structure
   â†“ AbsorptionDetector - Specification Compliance > SPECIFICATION: Signal Quality Requirements > MUST respect cooldown periods to prevent signal spam

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 1 â¯â¯â¯â¯â¯â¯â¯

 FAIL  test/absorptionDetector_specifications.test.ts > AbsorptionDetector - Specification Compliance > SPECIFICATION: Price Efficiency Analysis > MUST detect absorption when price efficiency is below threshold
AssertionError: expected false to be true // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

 â¯ test/absorptionDetector_specifications.test.ts:199:36
    197| 
    198|             // EXPECTED BEHAVIOR: Must detect absorption due to low prâ€¦
    199|             expect(signalDetected).toBe(true);
       |                                    ^
    200|         });
    201| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯


 Test Files  1 failed (1)
      Tests  1 failed | 12 skipped (13)
   Start at  18:30:36
   Duration  286ms (transform 72ms, setup 7ms, collect 82ms, tests 14ms, environment 0ms, prepare 26ms)

error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
